# wasmer.toml

# Define the package information
[package]
name = "php-laravel-app"
version = "0.1.0"
description = "A PHP Laravel application packaged for Wasmer"

# Define dependencies
[dependencies]
"php/php" = "^8.2"
"sharrattj/bash" = "^1.0.0"

# Setup command to install dependencies and build assets
[[command]]
name = "setup"
module = "sharrattj/bash:bash"
runner = "wasi"
[command.annotations.wasi]
main-args = [
  "-c",
  "cp .env.example .env && composer install --no-dev --no-interaction --prefer-dist && php artisan key:generate && npm install && npm run build"
]

# Map the project directory to /app in the container
[fs]
"app" = "."

# Define the command to run the application
[[command]]
name = "run"
module = "php/php:php"
runner = "wasi"
[command.annotations.wasi]
main-args = [
  "artisan",
  "serve",
  "--host=0.0.0.0",
  "--port=${PORT:-8080}"
]
