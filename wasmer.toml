# wasmer.toml - Production Version

[package]
name = "vodeco-keuangan"
version = "0.1.0"
description = "Aplikasi Keuangan Vodeco"

# Kita tambahkan nginx sebagai dependensi
[dependencies]
"php/php" = "^8.2"
"nginx/nginx" = "^1.25"
"sharrattj/bash" = "^1.0.0"

# Perintah setup tetap sama
[[command]]
name = "setup"
module = "sharrattj/bash:bash"
runner = "wasi"
[command.annotations.wasi]
main-args = [
  "-c",
  "cp .env.example .env && composer install --no-dev --no-interaction --optimize-autoloader && php artisan key:generate --force && npm install && npm run build"
]

# Mapping filesystem, kita tambahkan nginx.conf
[fs]
"app" = "."
"/etc/nginx" = "./nginx.conf"

# Perintah run sekarang menjalankan skrip start.sh
[[command]]
name = "run"
module = "sharrattj/bash"
runner = "wasi"
[command.annotations.wasi]
main-args = ["/app/start.sh"]